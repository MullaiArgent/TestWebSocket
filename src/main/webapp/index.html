<html lang="html">
<head>
    <base target="_parent">
    <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap"/>
    <link rel="stylesheet" href="https://mdbootstrap.com/api/snippets/static/download/MDB-Pro_4.20.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://mdbootstrap.com/api/snippets/static/download/MDB-Pro_4.20.0/css/mdb.min.css"/>
    <link rel="stylesheet" href="https://mdbootstrap.com/wp-content/themes/mdbootstrap4/docs-app/css/compiled-addons-4.20.0.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <!-- Cropper -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropper/2.3.4/cropper.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"/>
    <!-- Cropper -->
    <link href="style.css" rel="stylesheet">
    <script src="websocket.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
            integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
            crossorigin="anonymous">
    </script>
    <title id="title"></title>
</head>
<body data-new-gr-c-s-check-loaded="14.1047.0" data-gr-ext-installed="">
<div id="snippetContent">
<!--    <div class="container">-->
        <div class="row clearfix">
            <div class="col-lg-12">
                <div class="card chat-app">
                    <div id="recentChatList" class="people-list">
                        <ul class="notificationsbtn nav navbar-nav navbar-right">
                            <li id="notificationsli">
                                <a onclick="viewNotification()" id="notifications" href="#" id="drop3" role="button" class="dropdown-toggle" data-toggle="dropdown">
                                    <span class="fa-stack fa-2x"> <!-- onclick="viewNotification()"-->
                                        <i  class="fas fa-bell fa-2x"></i>
                                            <span  class="badge" id="badge"></span>  <!-- Notification Count -->
                                        </span></a>
                                <div id="notification-container" class="dropdown-menu" role="menu" aria-labelledby="drop3" style="position: absolute;transform: translate3d(0px, 86px, 0px);top: 0px;left: 0px;will-change: transform;width: fit-content;">
                                    <section class="panel">
                                        <header class="panel-heading">
                                            <strong>Notifications</strong>
                                        </header><div id="notification-list" class="list-group list-group-alt">
                                            <div style="" id="notificationDrop">
                                            </div>
                                    </div>
                                        <footer class="panel-footer">
                                            <a class="pull-right"></a>
                                            <a data-toggle="class:show animated fadeInRight"></a>
                                        </footer>
                                    </section>
                                </div>
                            </li>
                        </ul>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
                                    <i href="#" class="fas fa-user-plus fa-2x" style="cursor: pointer" onclick="addFriend()"></i>
                                </span>
                            </div>
                            <label>
                                <input type="text" id="addFriend" class="form-control" placeholder="Search...">
                            </label>  <!--Search results-->
                        </div>
                    <ul id="recentChatsUl" class="list-unstyled chat-list mt-2 mb-0">
                        <!---The Recent Chats will be populated here inside from the JS -->
                    </ul>
                    </div>
                    <div class="chat">
                        <!-- Opens the Overlay window for the multimedia -->
                        <span style="font-size:30px; cursor:pointer" onclick="openNav()">&#9776;</span>
                        <!-- Opens the Overlay window for the multimedia -->
                        <div class="chat-header clearfix">
                            <form action="logout" method="post">
                            <button class="logout button" type="submit">Log out</button>
                            </form>
                            <div class="row">
                                <div id="about" class="col-lg-6">
                                </div>
                            </div>
                        </div>
                        <div class="chat-history" id="chatHistory">
                            <ul class="m-b-0" id="chatList">
                                <!-- the Chat list will be populated here inside from the JS -->
                            </ul>
                        </div>
                        <div class="chat-message clearfix">
                            <div class="input-group mb-0">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="fa fa-send fa-2x" style="cursor: pointer" onclick="sendMessage()"></i>
                                    </span>
                                </div>
                                <label>
                                    <input id="messageToSend" type="text" class="form-control" placeholder="Enter text here...">
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Image Sender Overlay Portion starts -->
<div id="myNav" class="menuOverlay">
    <a href="javascript:void(0)" class="closeBtn" onclick="closeNav()">&times;</a>
    <div class="menuOverlay-content">
        <div class="container page">
            <div class="form-group container">
                <input class="form-control box" accept="image/*" type="file" required id="file-input"/>
            </div>
            <div class="box-2">
                <div class="result"></div>
            </div>
            <div class="box-2 img-result hide">
                <canvas id="canvas1"
                        width="200"
                        height="200"
                        style="border: 1px solid black;"
                ></canvas>
            </div>
            <div class="box">
                <div class="options hide">
                    <input type="number" class="img-w" value="300" min="100" max="1200" hidden/>
                </div>
                <button class="btn save hide">Save</button>
                <button id="clear" class="btn clear hide">Clear</button>
                <a onclick="return sendImage(this)" id="croppedImg" href="" class="btn download hide">Send Image</a>
            </div>
        </div>
    </div>
</div>
<!--Image Sender Overlay Portion ends -->
<!-- Overlay for the requests starts here -->
<div id="overlay" onclick="overlayOff()">
    <div id="fb">
        <div id="fb-top">
            <p><b id="popWindowType"></b></p>
        </div>
        <div id="forProfile"></div>
        <p><b id="popWindowFriendName"></b><br></p>
        <div id="button-block">
            <div id="popWindowButton"></div>
        </div>
    </div>
</div>
<!-- Overlay for the requests ends here -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/0.8.1/cropper.min.js"></script>
<script src="media.js"></script>
</body>
<script>
    // vars
    let result = document.querySelector(".result"),
        img_result = document.querySelector(".img-result"),
        img_w = document.querySelector(".img-w"),
        options = document.querySelector(".options"),
        save = document.querySelector(".save"),
        clear = document.querySelector(".clear"),
        cropped = document.getElementById("canvas1"),
        dwn = document.querySelector(".download"),
        upload = document.querySelector("#file-input"),
        cropper = "";
    upload.addEventListener("change", (e) => {
        if (e.target.files.length) {

            const reader = new FileReader();
            reader.onload = (e) => {
                if (e.target.result) {

                    let img = document.createElement("img");
                    img.id = "image";
                    img.src = e.target.result;

                    result.innerHTML = "";   // clean result before

                    result.appendChild(img);

                    save.classList.remove("hide");

                    options.classList.remove("hide");

                    cropper = new Cropper(img);
                }
            };
            reader.readAsDataURL(e.target.files[0]);
        }
    });
    let image;
    save.addEventListener("click", (event) => {
        event.preventDefault();
        let imgSrc = cropper.getCroppedCanvas({
                width: img_w.value,
            }).toDataURL();
        cropped.classList.remove("hide");
        clear.classList.remove("hide");
        img_result.classList.remove("hide");
        image = document.createElement("img");
        image.src = imgSrc;
        dwn.classList.remove("hide");
        dwn.setAttribute("href", imgSrc);
        image.addEventListener("load", () => {
            drawOnImage(image, dwn);
        });
    });
</script>
</html>